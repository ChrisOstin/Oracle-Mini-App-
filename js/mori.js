    let state = { price: 0.006887, change: -6.34, volume: 0, liquidity: 0, whales: [], news: [], chart: null};const formatPrice = window.utils.memoize((price) => { return `$${price.toFixed(6)}`;});const formatPercent = window.utils.memoize((percent) => { return `${percent >= 0 ? '+' : ''}${percent.toFixed(2)}%`;});async function loadPrice() { try { const data = await window.API.fetch(`${window.CONFIG.API_URL}/api/mori/price`); if (data.success) { state.price = data.price; state.change = data.change; state.volume = data.volume; state.liquidity = data.liquidity; updatePriceUI(); return data; } } catch (error) { window.utils.showToast('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ü–µ–Ω—ã', 'error'); console.error('Price error:', error); }}function updatePriceUI() { const priceEl = document.getElementById('mori-price'); const changeEl = document.getElementById('mori-change'); const priceBarEl = document.getElementById('mori-price-bar'); if (priceEl) { priceEl.textContent = formatPrice(state.price); } if (changeEl) { changeEl.textContent = formatPercent(state.change); changeEl.className = `change ${state.change >= 0 ? 'positive' : 'negative'}`; } if (priceBarEl) { priceBarEl.innerHTML = ` ${formatPrice(state.price)} <span class="change ${state.change >= 0 ? 'positive' : 'negative'}"> ${formatPercent(state.change)} </span> `; }}async function loadWhales() { try { const data = await window.API.fetch(`${window.CONFIG.API_URL}/api/mori/whales`); if (data.success) { state.whales = data.data.top_holders; renderWhales(); } } catch (error) { console.error('Whales error:', error); }}async function loadNews() { try { const data = await window.API.fetch(`${window.CONFIG.API_URL}/api/mori/news`); if (data.success) { state.news = data.data; renderNews(); } } catch (error) { console.error('News error:', error); }}function renderWhales() { const container = document.getElementById('whales-content'); if (!container) return; if (state.whales.length === 0) { container.innerHTML = '<div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∏—Ç–æ–≤...</div>'; return; } container.innerHTML = state.whales.map((whale, i) => ` <div class="whale-item"> <span class="rank">#${i+1}</span> <span class="address">${whale.short_address}</span> <span class="balance">${(whale.balance/1000000).toFixed(1)}M</span> <span class="percentage">${whale.percentage}%</span> </div> `).join('');}function renderNews() { const container = document.getElementById('news-content'); if (!container) return; if (state.news.length === 0) { container.innerHTML = '<div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π...</div>'; return; } container.innerHTML = state.news.map(item => ` <div class="news-item"> <div class="news-title">${item.title}</div> <div class="news-meta">${item.time} ‚Ä¢ ${item.reactions} üëç</div> </div> `).join('');}function initChart() { const ctx = document.getElementById('mori-chart')?.getContext('2d'); if (!ctx) return; if (state.chart) { state.chart.destroy(); } const data = generateMockData(state.price); state.chart = new Chart(ctx, { type: 'line', data: { labels: data.map(d => new Date(d.time).getHours() + ':00'), datasets: [{ data: data.map(d => d.value), borderColor: '#FFD700', backgroundColor: 'rgba(255, 215, 0, 0.1)', borderWidth: 2, fill: true, tension: 0.4, pointRadius: 0 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { grid: { color: '#333' }, ticks: { color: '#888' } }, x: { grid: { display: false }, ticks: { color: '#888' } } } } });}function generateMockData(basePrice) { const data = []; const now = Date.now(); for (let i = 24; i >= 0; i--) { data.push({ time: now - i * 3600000, value: basePrice * (1 + (Math.random() - 0.5) * 0.02) }); } return data;}const debouncedLoad = window.utils.debounce(loadPrice, 1000);export async function render(container) { container.innerHTML = ` <div class="mori-screen"> <div class="mori-header"> <div class="price-container"> <span class="label">$MORI</span> <span class="price" id="mori-price">${formatPrice(state.price)}</span> <span class="change ${state.change >= 0 ? 'positive' : 'negative'}" id="mori-change"> ${formatPercent(state.change)} </span> </div> <button class="refresh-btn" onclick="window.refreshMori()">üîÑ</button> </div> <div class="stats-grid"> <div class="stat-card"> <div class="label">–û–±—ä—ë–º 24—á</div> <div class="value">$${(state.volume/1000000).toFixed(2)}M</div> </div> <div class="stat-card"> <div class="label">–õ–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å</div> <div class="value">$${(state.liquidity/1000000).toFixed(2)}M</div> </div> </div> <div class="chart-container"> <canvas id="mori-chart"></canvas> <div class="timeframes"> <button class="timeframe-btn active" data-hours="24">24—á</button> <button class="timeframe-btn" data-hours="168">7–¥</button> <button class="timeframe-btn" data-hours="720">30–¥</button> </div> </div> <div class="actions-grid"> <button class="action-btn" onclick="window.toggleSection('whales')">üê≥ –ö–∏—Ç—ã</button> <button class="action-btn" onclick="window.toggleSection('news')">üì∞ –ù–æ–≤–æ—Å—Ç–∏</button> <button class="action-btn" onclick="window.openCalculator()">üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</button> <button class="action-btn" onclick="window.openStaking()">üìà –°—Ç–µ–π–∫–∏–Ω–≥</button> <button class="action-btn" onclick="window.openReader()">üìö –ß–∏—Ç–∞–ª–∫–∞</button> <button class="action-btn" onclick="window.open('https: </div> <div id="whales-section" class="toggle-section hidden"> <h3>üê≥ –ö—Ä—É–ø–Ω—ã–µ –¥–µ—Ä–∂–∞—Ç–µ–ª–∏</h3> <div id="whales-content" class="whales-content">–ó–∞–≥—Ä—É–∑–∫–∞...</div> </div> <div id="news-section" class="toggle-section hidden"> <h3>üì∞ –ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏</h3> <div id="news-content" class="news-content">–ó–∞–≥—Ä—É–∑–∫–∞...</div> </div> </div> `; initChart(); await loadPrice(); await loadWhales(); await loadNews(); window.core.setManagedInterval(loadPrice, 30000);}window.refreshMori = () => { loadPrice(); loadWhales(); loadNews();};window.toggleSection = (section) => { const el = document.getElementById(`${section}-section`); if (el) { el.classList.toggle('hidden'); }};
