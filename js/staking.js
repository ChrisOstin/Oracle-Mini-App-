    let selectedPeriod = 1;const periods = { 1: { apr: 23, months: 1, endDate: '27.03.2026' }, 3: { apr: 45, months: 3, endDate: '27.05.2026' }, 6: { apr: 90, months: 6, endDate: '27.08.2026' }, 12: { apr: 100, months: 12, endDate: '27.02.2027' }};function calculateReward(amount) { const period = periods[selectedPeriod]; if (!period || !amount) return 0; const yearlyReward = amount * (period.apr / 100); const monthlyReward = yearlyReward / 12; return monthlyReward * period.months;}export function openStakingModal() { const modal = document.createElement('div'); modal.className = 'modal'; modal.id = 'staking-modal'; modal.innerHTML = ` <div class="modal-content"> <div class="modal-header"> <h2>üìà –°—Ç–µ–π–∫–∏–Ω–≥ MORI</h2> <button class="close-btn" onclick="window.closeModal('staking')">&times;</button> </div> <div class="modal-body"> <div class="staking-periods"> ${Object.entries(periods).map(([months, data]) => ` <div class="period-card ${months == selectedPeriod ? 'selected' : ''}" data-months="${months}"> <div class="period-months">${data.months} –º–µ—Å</div> <div class="period-apr">${data.apr}% APR</div> <div class="period-date">–¥–æ ${data.endDate}</div> </div> `).join('')} </div> <div class="staking-input"> <input type="number" id="stake-amount" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ MORI"> </div> <div id="staking-result" class="staking-result"></div> <button class="staking-btn" id="create-stake-btn">üîí –ó–∞—Å—Ç–µ–π–∫–∞—Ç—å</button> </div> </div> `; document.body.appendChild(modal); document.querySelectorAll('.period-card').forEach(card => { window.core.addManagedListener(card, 'click', () => { document.querySelectorAll('.period-card').forEach(c => c.classList.remove('selected') ); card.classList.add('selected'); selectedPeriod = parseInt(card.dataset.months); updateStakingResult(); }); }); const input = document.getElementById('stake-amount'); window.core.addManagedListener(input, 'input', updateStakingResult); window.core.addManagedListener(document.getElementById('create-stake-btn'), 'click', createStake); function updateStakingResult() { const amount = parseFloat(input.value) || 0; const period = periods[selectedPeriod]; if (!period) return; const reward = calculateReward(amount); const total = amount + reward; document.getElementById('staking-result').innerHTML = ` <div>üìÖ –ü–µ—Ä–∏–æ–¥: ${period.months} –º–µ—Å (–¥–æ ${period.endDate})</div> <div>üìà APR: ${period.apr}%</div> <div>üí∞ –ù–∞–≥—Ä–∞–¥–∞: ${reward.toFixed(2)} MORI</div> <div>üíé –ò—Ç–æ–≥–æ: ${total.toFixed(2)} MORI</div> `; } function createStake() { if (!window.currentUser) { window.utils.showToast('‚ùå –°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å', 'error'); return; } const amount = parseFloat(input.value); if (!amount || amount <= 0) { window.utils.showToast('‚ùå –í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ MORI', 'error'); return; } const period = periods[selectedPeriod]; const reward = calculateReward(amount); const endDate = new Date(); endDate.setMonth(endDate.getMonth() + period.months); const stake = { amount, period: period.months, apr: period.apr, reward, total: amount + reward, endDate: endDate.toLocaleDateString('ru-RU') }; if (!window.currentUser.stakes) window.currentUser.stakes = []; window.currentUser.stakes.push(stake); window.currentUser.stats.staking += amount; localStorage.setItem('oracle_user', JSON.stringify(window.currentUser)); window.utils.showToast(`‚úÖ –ó–∞—Å—Ç–µ–π–∫–∞–Ω–æ ${amount} MORI!`, 'success'); window.closeModal('staking'); import('./profile.js').then(module => { module.render(document.getElementById('profile-container')); }); }}window.openStaking = openStakingModal;
