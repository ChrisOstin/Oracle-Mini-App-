    const loadTrendingMemo = window.utils.memoize(async () => { try { const data = await window.API.fetch('https: return data.coins.slice(0, 4); } catch (error) { console.error('Trending error:', error); return []; }}, () => 'trending');export async function render(container) { container.innerHTML = ` <div class="crypto-screen"> <div class="search-box"> <input type="text" id="crypto-search" placeholder="BTC, ETH, SOL..."> <button id="crypto-search-btn">üí∞</button> </div> <div class="trending-section"> <h3>üî• –ü–æ–ø—É–ª—è—Ä–Ω–æ–µ —Å–µ–π—á–∞—Å</h3> <div id="trending-coins" class="trending-grid"> <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div> </div> </div> <div id="crypto-result" class="crypto-result"></div> </div> `; const trending = await loadTrendingMemo(); const trendingDiv = document.getElementById('trending-coins'); if (trending.length > 0) { trendingDiv.innerHTML = trending.map(coin => ` <div class="trending-item" data-coin="${coin.item.id}"> <div class="name">${coin.item.name}</div> <div class="symbol">${coin.item.symbol}</div> </div> `).join(''); document.querySelectorAll('.trending-item').forEach(item => { window.core.addManagedListener(item, 'click', () => { searchCrypto(item.dataset.coin); }); }); } const searchInput = document.getElementById('crypto-search'); const searchBtn = document.getElementById('crypto-search-btn'); async function searchCrypto(coinId = null) { const query = coinId || searchInput.value; if (!query) return; const resultDiv = document.getElementById('crypto-result'); resultDiv.innerHTML = '<div class="loading">üí∞ –ó–∞–≥—Ä—É–∑–∫–∞...</div>'; try { const data = await window.API.fetch(`${window.CONFIG.API_URL}/api/crypto/price?coin=${query}`); if (data.success) { const price = data.data[query]?.usd; const change = data.data[query]?.usd_24h_change; resultDiv.innerHTML = ` <div class="crypto-price-card"> <div class="coin-name">${query.toUpperCase()}/USD</div> <div class="price-value ${change >= 0 ? 'positive' : 'negative'}"> $${price.toFixed(2)} </div> <div class="price-change ${change >= 0 ? 'positive' : 'negative'}"> ${change >= 0 ? '+' : ''}${change.toFixed(2)}% </div> </div> `; } } catch (error) { resultDiv.innerHTML = '<div class="error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>'; window.utils.showToast('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –∫—Ä–∏–ø—Ç—ã', 'error'); } } window.core.addManagedListener(searchBtn, 'click', () => searchCrypto()); window.core.addManagedListener(searchInput, 'keypress', (e) => { if (e.key === 'Enter') searchCrypto(); }); window.searchCrypto = searchCrypto;}
